<br>Ce thread vise à faire le point et apporter des solutions pour les cartes Arduino/Diduino non reconnues par le système d'exploitation. Il sera mis à jour si de nouvelles solutions apparaissent.<br><br><b>Contexte</b><br><br>Les cartes Arduino sont souvent équipées d'une puce FTDI. Le modèle 232R ayant un grand succès, la contrefaçon s'y est intéressée.<br>FTDI a donc sorti un pilote (version 2.12) sous Windows qui détecte les puces contrefaites, et les "désactive" en reprogrammant le PID (ProductID) de la carte : Concrètement, l'identifiant de la carte sur le port USB est modifié et celle-ci n'est plus reconnue par les pilotes FTDI.<br><br><b>Comment savoir si la puce FTDI équipant votre carte est contrefaite?</b><br><br>Sous Windows, dans le gestionnaire de périphériques, vous verrez certainement ceci :<br><img alt="ftdi_windows.jpg" style="width:214px;height:248px;" src="https://coursera-forum-screenshots.s3.amazonaws.com/ea/2852f0708511e48238639ea9491fb4/ftdi_windows.jpg"><br><br>Sous Linux, ouvrez un terminal et tapez lsusb. Vous devriez trouver une ligne de ce style.<br><pre><code>Bus 004 Device 003: ID 0403:0000 Future Technology Devices International, Ltd FT232 USB-Serial (UART) IC</code></pre>Si votre puce FTDI est modifiée, l'ID affiche 0403:0000 au lieu de 0403:6001 pour une originale.<br><br><b>Solutions</b><br><br>Suivant votre système d'exploitation, plusieurs solutions sont disponibles.<br>- Vous travaillez exclusivement sous Windows.<br>- Vous travaillez exclusivement sous Linux ou OSX.<br>-  Cas particuliers.<br><br><br><br><br><a target=""></a><b><u></u></b><h3><b><u>Vous travaillez exclusivement sous Windows.</u></b></h3><b><u></u></b><br>La solution la plus simple est d'installer le pilote "manuellement" en gardant le PID à 0x0000. Cette vidéo décrit la procédure:<br><a target="" href="https://www.youtube.com/watch?v=SPdSKT6KdF8">https://www.youtube.com/watch?v=SPdSKT6KdF8</a> <br>La solution fonctionne avec les pilotes FTDI 2.12, mais également avec les 2.10 que vous pouvez télécharger ici:<br>32 bits : <a target="" href="http://www.ftdichip.com/Drivers/CDM/CDM%20v2.10.00%20WHQL%20Certified.zip">http://www.ftdichip.com/Drivers/CDM/CDM%20v2.10.00%20WHQL%20Certified.zip</a><br>64 bits : <a target="" href="http://www.ftdichip.com/Drivers/CDM/CDM%20v2.10.00%20WHQL%20Certified.zip">http://www.ftdichip.com/Drivers/CDM/CDM%20v2.10.00%20WHQL%20Certified.zip</a><br><br><b>Le cas Windows 8/8.1/10 (64 bits, inconnu pour 32 bits)</b><br><br>A partir de Windows 8, les pilotes font l'objet d'un contrôle accru : Les pilotes non-signés ne sont pas chargés. Pour que la solution proposée fonctionne, ils faut désactiver le contrôle systématique de la signature des pilotes. Ce lien vous sera utile...<br><br><a target="" href="http://www.howtogeek.com/167723/how-to-disable-driver-signature-verification-on-64-bit-windows-8.1-so-that-you-can-install-unsigned-drivers/">http://www.howtogeek.com/167723/how-to-disable-driver-signature-verification-on-64-bit-windows-8.1-so-that-you-can-install-unsigned-drivers/</a> <br><br>Cependant, suivant la façon dont Windows est installé, l'option "Troubleshoot" n'est pas disponible... Et peut-être souhaitez vous garder la sécurité apportée par la vérification systématique des pilotes.<br>Une autre solution est donc de reprogrammer la puce, désinstaller les pilotes 2.12 et installer les 2.10.<br><br><br><br><br><a target=""></a><b><u></u></b><h3><b><u>Vous travaillez exclusivement sous Linux ou OS X</u></b></h3><b><u></u></b><br>La solution la plus simple semble être de reprogrammer le PID de la puce FTDI. Le programme ft232r_prog y arrive très bien.<br><br><b>Sous Arch</b><br><br>Sous Arch, ft232r_prog est disponible depuis AUR. Il suffit d'ouvrir un terminal et de taper:<br><pre><code>yaourt -S ft232r_prog</code></pre>Puis vient le moment de reprogrammer le PID. Toujours dans le terminal, entrer:<br><pre><code>sudo ft232r_prog --old-pid 0x0000 --new-pid 0x6001</code></pre>Débranchez et rebranchez la carte, si besoin redémarrez.<br>Vous pouvez vérifier le succès de l'opération avec lsusb, qui devrait donner:<br><pre><code>Bus 004 Device 003: ID 0403:6001 Future Technology Devices International, Ltd FT232 USB-Serial (UART) IC</code></pre><br><br><b>Sous Ubuntu</b><br><br>Ce lien décrit une solution pour Ubuntu.<br><a target="" href="http://forum.arduino.cc/index.php?topic=274387.0">http://forum.arduino.cc/index.php?topic=274387.0</a> <br>Si vous n'êtes pas familier avec git ou n'avez pas de compte github, vous pouvez simplement charger les sources du programme ici:<br><a target="" href="http://www.rtr.ca/ft232r/ft232r_prog-1.24.tar.gz">http://www.rtr.ca/ft232r/ft232r_prog-1.24.tar.gz</a> <br>Décompressez, puis suivez la procédure depuis cd ft232r_prog, c'est à dire<br><pre><code>cd ft232r_prog<br>sudo apt-get install build-essential gcc make libftdi-dev<br>make</code></pre>puis<br><pre><code>sudo ./ft232r_prog&nbsp; --old-pid 0x0000 --new-pid 0x6001</code></pre>Débrancher puis rebrancher la carte.<br><br><br><b>Sous OS X</b><br><br>Installer Macports : <a target="" href="https://www.macports.org/install.php">https://www.macports.org/install.php</a><br>Dans un terminal, installer libftdi0<br><pre><code>sudo port install libftdi0</code></pre>Télécharger les sources de ft232r_prog : <a target="" href="http://www.rtr.ca/ft232r/ft232r_prog-1.24.tar.gz">http://www.rtr.ca/ft232r/ft232r_prog-1.24.tar.gz</a><br>Décompresser l'archive et éditer le makefile, qui doit ressembler à ceci :<br><pre><code>CFLAGS = -Wall -O2 -s -Werror -I/opt/local/include<br>LDFLAGS =  -L/opt/local/lib -lusb -lftdi -s<br>PROG = ft232r_prog<br><br>all:	$(PROG)<br><br>$(PROG):	$(PROG).c<br>	$(CC) $(CFLAGS) -o $@ $&lt; $(LDFLAGS)<br><br>clean:<br>	rm -f $(PROG)</code></pre>Depus le terminal, entrer dans le répertoire de l'archive, et entrer make pour compiler le programme.<br>Puis modifier le PID de la puce FTDI :<br><pre><code>sudo ./ft232r_prog&nbsp; --old-pid 0x0000 --new-pid 0x6001</code></pre>Débrancher et rebrancher la carte.<br><br><br><br><b>Autres solutions</b><br><br>Patcher le pilote dans le noyau Linux avec le PID 0x0000 et recompiler le noyau....<br><br><br><br><a target=""></a><b><u></u></b><h3><b><u>Cas particuliers</u></b></h3><b><u></u></b><br><b>Reprogrammer la puce sous Windows et désinstaller les pilotes 2.12.</b><br><br>Vous pouvez tenter de reprogrammer la puce sous WIndows avec l'outil Mprog de FTDI. Cette vidéo montre le processus : <a target="" href="https://www.youtube.com/watch?v=RZH_qGautqM">https://www.youtube.com/watch?v=RZH_qGautqM</a> <br><br>Problème, il est possible que la puce ne soit pas reconnue. Vous pouvez donc passer par Linux pour reprogrammer votre puce.<br><br>Puis, une fois reprogrammée, vous pouvez démarrer Windows et brancher la carte qui devrait être reconnue.<br>Aller dans le gestionnaire de périphériques, onglet Ports où doit se trouver le port COM associé à la carte (COM 3 ou 4 généralement).<br>Clic droit sur le port =&gt; propriétés =&gt; onglet pilote =&gt; désinstaller =&gt; au passage, cocher la désinstallation du logiciel du pilote.<br>Débrancher la carte et redémarrer Windows. Ne rebrancher la carte que lorsque vous êtes sur le bureau.<br>Si besoin, installer les pilotes 2.10 disponibles <a target="" href="https://class.coursera.org/microcontroleurs-004/forum/thread?thread_id=180#post-956">ici</a>.<br><br><br>